{% import '@SyliusShop/shared/buttons.html.twig' as buttons %}
{% set order = hookable_metadata.context.order %}
{% set lastPayment = order.payments.last() %}

{% if lastPayment.state != constant('Sylius\\Component\\Payment\\Model\\PaymentInterface::STATE_COMPLETED') %}
    {{ buttons.primary(path('sylius_shop_order_show', {'tokenValue': order.tokenValue}), 'sylius.ui.change_payment_method'|trans, 'payment-method-page', null) }}
{% endif %}
